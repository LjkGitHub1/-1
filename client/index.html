<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="webkit" name="renderer" />
    <meta
      content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=0"
      name="viewport"
    />
    <title>xadmin</title>
    <link href="/favicon.ico" rel="icon" />
    <script>
      window.process = {};
    </script>
  </head>

  <body>
    <div id="app">
      <style>
        html,
        body,
        #app {
          position: relative;
          display: flex;
          align-items: center;
          justify-content: center;
          width: 100%;
          height: 100%;
          overflow: hidden;
        }

        .loader,
        .loader::before,
        .loader::after {
          width: 2.5em;
          height: 2.5em;
          border-radius: 50%;
          animation: load-animation 1.8s infinite ease-in-out;
          animation-fill-mode: both;
        }

        .loader {
          position: relative;
          top: 0;
          margin: 80px auto;
          font-size: 10px;
          color: #406eeb;
          text-indent: -9999em;
          transform: translateZ(0);
          transform: translate(-50%, 0);
          animation-delay: -0.16s;
        }

        .loader::before,
        .loader::after {
          position: absolute;
          top: 0;
          content: "";
        }

        .loader::before {
          left: -3.5em;
          animation-delay: -0.32s;
        }

        .loader::after {
          left: 3.5em;
        }

        @keyframes load-animation {
          0%,
          80%,
          100% {
            box-shadow: 0 2.5em 0 -1.3em;
          }

          40% {
            box-shadow: 0 2.5em 0 0;
          }
        }
      </style>
      <div class="loader"></div>
    </div>
    <!-- 背景音乐（尝试自动播放） -->
    <audio id="bg-audio" src="/bg-music.mp3" preload="auto" loop></audio>
    <style>
      /* 自动播放被浏览器阻止时的提示样式（轻量、不可阻塞） */
      #audio-hint {
        position: fixed;
        right: 12px;
        bottom: 12px;
        z-index: 9999;
        padding: 8px 12px;
        font-size: 13px;
        color: #fff;
        cursor: pointer;
        background: rgb(0 0 0 / 60%);
        border-radius: 6px;
        backdrop-filter: blur(4px);
      }
    </style>
    <script>
      // 尝试在页面加载时自动播放背景音乐。注意：浏览器的自动播放策略可能阻止未静音的音频自动播放。
      (function () {
        const audio = document.getElementById('bg-audio');
        if (!audio) return;
        // 轻柔音量
        try { audio.volume = 0.45; } catch (e) {}

        function showHint() {
          if (document.getElementById('audio-hint')) return;
          const hint = document.createElement('div');
          hint.id = 'audio-hint';
          hint.innerText = '点击开启背景音乐';
          hint.title = '如果没有自动播放，请点我开启声音';
          hint.onclick = function () {
            // 解除静音并尝试播放
            try { audio.muted = false; audio.play(); } catch (e) {}
            hint.remove();
          };
          document.body.appendChild(hint);
        }

        // 首次尝试播放
        const playAttempt = audio.play();
        if (playAttempt !== undefined) {
          playAttempt
            .then(() => {
              // 自动播放成功，确保提示不存在
              const h = document.getElementById('audio-hint');
              if (h) h.remove();
            })
            .catch(() => {
              // 自动播放被阻止 —— 尝试静音播放（某些浏览器允许静音自动播放）
              try {
                audio.muted = true;
                audio.play().catch(() => {});
              } catch (e) {}
              // 显示提示以便用户手动开启声音（当用户点击页面时）
              showHint();
            });
        }

        // 另外监听用户第一次交互，尝试恢复非静音播放（增加被允许的概率）
        function onInteraction() {
          try {
            audio.muted = false;
            audio.play().catch(() => {});
          } catch (e) {}
          window.removeEventListener('click', onInteraction);
          window.removeEventListener('keydown', onInteraction);
        }
        window.addEventListener('click', onInteraction);
        window.addEventListener('keydown', onInteraction);
      })();
    </script>
    <script src="/src/main.ts" type="module"></script>
  </body>
</html>
